"use babel";

describe('The GCC provider for AtomLinter', function () {
  var main = require('../lib/main');
  var utility = require('../lib/utility.js');
  var settings = require("../lib/config").settings;

  beforeEach(function () {
    waitsForPromise(function () {
      main.messages = {};
      atom.config.set('linter-gcc.execPath', '/usr/bin/g++');
      atom.config.set('linter-gcc.gccDefaultCFlags', '-c -Wall -o /dev/null');
      atom.config.set('linter-gcc.gccDefaultCppFlags', '-c -Wall -std=c++11 -o /dev/null');
      atom.config.set('linter-gcc.gccErrorLimit', 15);
      atom.config.set('linter-gcc.gccIncludePaths', ' ');
      atom.config.set('linter-gcc.gccSuppressWarnings', true);
      atom.config.set('linter-gcc.gccLintOnTheFly', false);
      atom.config.set('linter-gcc.gccDebug', false);
      atom.config.set('linter-gcc.gccErrorString', 'error');
      atom.config.set('linter-gcc.gccWarningString', 'warning');
      atom.config.set('linter-gcc.gccNoteString', 'note');
      atom.packages.activatePackage('language-c');
      return atom.packages.activatePackage('linter-gcc');
    });
  });

  it('finds one error in error.cpp', function () {
    waitsForPromise(function () {
      filename = __dirname + '/files/error.cpp';
      return atom.workspace.open(filename).then(function (editor) {
        return main.lint(editor, editor.getPath(), editor.getPath()).then(function () {
          var length = utility.flattenHash(main.messages).length;
          expect(length).toEqual(1);
        });
      });
    });
  });

  it('finds no errors in comment.cpp', function () {
    waitsForPromise(function () {
      filename = __dirname + '/files/comment.cpp';
      return atom.workspace.open(filename).then(function (editor) {
        return main.lint(editor, editor.getPath(), editor.getPath()).then(function () {
          var length = utility.flattenHash(main.messages).length;
          expect(length).toEqual(0);
        });
      });
    });
  });

  it('finds one error in error.c', function () {
    waitsForPromise(function () {
      filename = __dirname + '/files/error.c';
      return atom.workspace.open(filename).then(function (editor) {
        return main.lint(editor, editor.getPath(), editor.getPath()).then(function () {
          var length = utility.flattenHash(main.messages).length;
          expect(length).toEqual(1);
        });
      });
    });
  });

  it('finds no errors in comment.c', function () {
    waitsForPromise(function () {
      filename = __dirname + '/files/comment.c';
      return atom.workspace.open(filename).then(function (editor) {
        return main.lint(editor, editor.getPath(), editor.getPath()).then(function () {
          var length = utility.flattenHash(main.messages).length;
          expect(length).toEqual(0);
        });
      });
    });
  });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2xvaWMvLmF0b20vcGFja2FnZXMvbGludGVyLWdjYy9zcGVjL2xpbnRlci1nY2Mtc3BlYy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxXQUFXLENBQUM7O0FBRVosUUFBUSxDQUFDLGlDQUFpQyxFQUFFLFlBQU07QUFDaEQsTUFBTSxJQUFJLEdBQUcsT0FBTyxDQUFDLGFBQWEsQ0FBQyxDQUFBO0FBQ25DLE1BQU0sT0FBTyxHQUFHLE9BQU8sQ0FBQyxtQkFBbUIsQ0FBQyxDQUFBO0FBQzVDLE1BQUksUUFBUSxHQUFHLE9BQU8sQ0FBQyxlQUFlLENBQUMsQ0FBQyxRQUFRLENBQUE7O0FBRWhELFlBQVUsQ0FBQyxZQUFNO0FBQ2YsbUJBQWUsQ0FBQyxZQUFNO0FBQ3BCLFVBQUksQ0FBQyxRQUFRLEdBQUcsRUFBRSxDQUFDO0FBQ25CLFVBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLHFCQUFxQixFQUFFLGNBQWMsQ0FBQyxDQUFBO0FBQ3RELFVBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLDZCQUE2QixFQUFFLHVCQUF1QixDQUFDLENBQUE7QUFDdkUsVUFBSSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsK0JBQStCLEVBQUUsa0NBQWtDLENBQUMsQ0FBQTtBQUNwRixVQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQywwQkFBMEIsRUFBRSxFQUFFLENBQUMsQ0FBQTtBQUMvQyxVQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyw0QkFBNEIsRUFBRSxHQUFHLENBQUMsQ0FBQTtBQUNsRCxVQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxnQ0FBZ0MsRUFBRSxJQUFJLENBQUMsQ0FBQTtBQUN2RCxVQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyw0QkFBNEIsRUFBRSxLQUFLLENBQUMsQ0FBQTtBQUNwRCxVQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxxQkFBcUIsRUFBRSxLQUFLLENBQUMsQ0FBQTtBQUM3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QkFBZSxDQUFDLFlBQU07QUFDcEIsY0FBUSxHQUFHLFNBQVMsR0FBRyxrQkFBa0IsQ0FBQTtBQUN6QyxhQUFPLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFBLE1BQU0sRUFBSTtBQUNsRCxlQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLE1BQU0sQ0FBQyxPQUFPLEVBQUUsRUFBRSxNQUFNLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsWUFBVztBQUMzRSxjQUFJLE1BQU0sR0FBRyxPQUFPLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxNQUFNLENBQUE7QUFDdEQsZ0JBQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDM0IsQ0FBQyxDQUFBO09BQ0gsQ0FBQyxDQUFBO0tBQ0gsQ0FBQyxDQUFBO0dBQ0gsQ0FBQyxDQUFBO0NBQ0gsQ0FBQyxDQUFBIiwiZmlsZSI6Ii9ob21lL2xvaWMvLmF0b20vcGFja2FnZXMvbGludGVyLWdjYy9zcGVjL2xpbnRlci1nY2Mtc3BlYy5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIGJhYmVsXCI7XG5cbmRlc2NyaWJlKCdUaGUgR0NDIHByb3ZpZGVyIGZvciBBdG9tTGludGVyJywgKCkgPT4ge1xuICBjb25zdCBtYWluID0gcmVxdWlyZSgnLi4vbGliL21haW4nKVxuICBjb25zdCB1dGlsaXR5ID0gcmVxdWlyZSgnLi4vbGliL3V0aWxpdHkuanMnKVxuICB2YXIgc2V0dGluZ3MgPSByZXF1aXJlKFwiLi4vbGliL2NvbmZpZ1wiKS5zZXR0aW5nc1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIHdhaXRzRm9yUHJvbWlzZSgoKSA9PiB7XG4gICAgICBtYWluLm1lc3NhZ2VzID0ge307XG4gICAgICBhdG9tLmNvbmZpZy5zZXQoJ2xpbnRlci1nY2MuZXhlY1BhdGgnLCAnL3Vzci9iaW4vZysrJylcbiAgICAgIGF0b20uY29uZmlnLnNldCgnbGludGVyLWdjYy5nY2NEZWZhdWx0Q0ZsYWdzJywgJy1jIC1XYWxsIC1vIC9kZXYvbnVsbCcpXG4gICAgICBhdG9tLmNvbmZpZy5zZXQoJ2xpbnRlci1nY2MuZ2NjRGVmYXVsdENwcEZsYWdzJywgJy1jIC1XYWxsIC1zdGQ9YysrMTEgLW8gL2Rldi9udWxsJylcbiAgICAgIGF0b20uY29uZmlnLnNldCgnbGludGVyLWdjYy5nY2NFcnJvckxpbWl0JywgMTUpXG4gICAgICBhdG9tLmNvbmZpZy5zZXQoJ2xpbnRlci1nY2MuZ2NjSW5jbHVkZVBhdGhzJywgJyAnKVxuICAgICAgYXRvbS5jb25maWcuc2V0KCdsaW50ZXItZ2NjLmdjY1N1cHByZXNzV2FybmluZ3MnLCB0cnVlKVxuICAgICAgYXRvbS5jb25maWcuc2V0KCdsaW50ZXItZ2NjLmdjY0xpbnRPblRoZUZseScsIGZhbHNlKVxuICAgICAgYXRvbS5jb25maWcuc2V0KCdsaW50ZXItZ2NjLmdjY0RlYnVnJywgZmFsc2UpXG4gICAgICBhdG9tLmNvbmZpZy5zZXQoJ2xpbnRlci1nY2MuZ2NjRXJyb3JTdHJpbmcnLCAnZXJyb3InKVxuICAgICAgYXRvbS5jb25maWcuc2V0KCdsaW50ZXItZ2NjLmdjY1dhcm5pbmdTdHJpbmcnLCAnd2FybmluZycpXG4gICAgICBhdG9tLmNvbmZpZy5zZXQoJ2xpbnRlci1nY2MuZ2NjTm90ZVN0cmluZycsICdub3RlJylcbiAgICAgIGF0b20ucGFja2FnZXMuYWN0aXZhdGVQYWNrYWdlKCdsYW5ndWFnZS1jJylcbiAgICAgIHJldHVybiBhdG9tLnBhY2thZ2VzLmFjdGl2YXRlUGFja2FnZSgnbGludGVyLWdjYycpXG4gICAgfSlcbiAgfSlcblxuICBpdCgnZmluZHMgb25lIGVycm9yIGluIGVycm9yLmNwcCcsICgpID0+IHtcbiAgICB3YWl0c0ZvclByb21pc2UoKCkgPT4ge1xuICAgICAgZmlsZW5hbWUgPSBfX2Rpcm5hbWUgKyAnL2ZpbGVzL2Vycm9yLmNwcCdcbiAgICAgIHJldHVybiBhdG9tLndvcmtzcGFjZS5vcGVuKGZpbGVuYW1lKS50aGVuKGVkaXRvciA9PiB7XG4gICAgICAgIHJldHVybiBtYWluLmxpbnQoZWRpdG9yLCBlZGl0b3IuZ2V0UGF0aCgpLCBlZGl0b3IuZ2V0UGF0aCgpKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciBsZW5ndGggPSB1dGlsaXR5LmZsYXR0ZW5IYXNoKG1haW4ubWVzc2FnZXMpLmxlbmd0aFxuICAgICAgICAgIGV4cGVjdChsZW5ndGgpLnRvRXF1YWwoMSk7XG4gICAgICAgIH0pXG4gICAgICB9KVxuICAgIH0pXG4gIH0pXG5cbiAgaXQoJ2ZpbmRzIG5vIGVycm9ycyBpbiBjb21tZW50LmNwcCcsICgpID0+IHtcbiAgICB3YWl0c0ZvclByb21pc2UoKCkgPT4ge1xuICAgICAgZmlsZW5hbWUgPSBfX2Rpcm5hbWUgKyAnL2ZpbGVzL2NvbW1lbnQuY3BwJ1xuICAgICAgcmV0dXJuIGF0b20ud29ya3NwYWNlLm9wZW4oZmlsZW5hbWUpLnRoZW4oZWRpdG9yID0+IHtcbiAgICAgICAgcmV0dXJuIG1haW4ubGludChlZGl0b3IsIGVkaXRvci5nZXRQYXRoKCksIGVkaXRvci5nZXRQYXRoKCkpLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdmFyIGxlbmd0aCA9IHV0aWxpdHkuZmxhdHRlbkhhc2gobWFpbi5tZXNzYWdlcykubGVuZ3RoXG4gICAgICAgICAgZXhwZWN0KGxlbmd0aCkudG9FcXVhbCgwKTtcbiAgICAgICAgfSlcbiAgICAgIH0pXG4gICAgfSlcbiAgfSlcblxuICBpdCgnZmluZHMgb25lIGVycm9yIGluIGVycm9yLmMnLCAoKSA9PiB7XG4gICAgd2FpdHNGb3JQcm9taXNlKCgpID0+IHtcbiAgICAgIGZpbGVuYW1lID0gX19kaXJuYW1lICsgJy9maWxlcy9lcnJvci5jJ1xuICAgICAgcmV0dXJuIGF0b20ud29ya3NwYWNlLm9wZW4oZmlsZW5hbWUpLnRoZW4oZWRpdG9yID0+IHtcbiAgICAgICAgcmV0dXJuIG1haW4ubGludChlZGl0b3IsIGVkaXRvci5nZXRQYXRoKCksIGVkaXRvci5nZXRQYXRoKCkpLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdmFyIGxlbmd0aCA9IHV0aWxpdHkuZmxhdHRlbkhhc2gobWFpbi5tZXNzYWdlcykubGVuZ3RoXG4gICAgICAgICAgZXhwZWN0KGxlbmd0aCkudG9FcXVhbCgxKTtcbiAgICAgICAgfSlcbiAgICAgIH0pXG4gICAgfSlcbiAgfSlcblxuICBpdCgnZmluZHMgbm8gZXJyb3JzIGluIGNvbW1lbnQuYycsICgpID0+IHtcbiAgICB3YWl0c0ZvclByb21pc2UoKCkgPT4ge1xuICAgICAgZmlsZW5hbWUgPSBfX2Rpcm5hbWUgKyAnL2ZpbGVzL2NvbW1lbnQuYydcbiAgICAgIHJldHVybiBhdG9tLndvcmtzcGFjZS5vcGVuKGZpbGVuYW1lKS50aGVuKGVkaXRvciA9PiB7XG4gICAgICAgIHJldHVybiBtYWluLmxpbnQoZWRpdG9yLCBlZGl0b3IuZ2V0UGF0aCgpLCBlZGl0b3IuZ2V0UGF0aCgpKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciBsZW5ndGggPSB1dGlsaXR5LmZsYXR0ZW5IYXNoKG1haW4ubWVzc2FnZXMpLmxlbmd0aFxuICAgICAgICAgIGV4cGVjdChsZW5ndGgpLnRvRXF1YWwoMCk7XG4gICAgICAgIH0pXG4gICAgICB9KVxuICAgIH0pXG4gIH0pXG59KVxuIl19
//# sourceURL=/home/loic/.atom/packages/linter-gcc/spec/linter-gcc-spec.js
